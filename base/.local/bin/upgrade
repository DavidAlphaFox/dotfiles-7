#!/bin/zsh

echo -e "\e[1;38m:: Updating dotfiles...\e[0m"
cd ~/.dotfiles
git stash
git pull
git stash pop
~/.dotfiles/base/.local/bin/restow

yaourt -Sy --aur
echo -e "\e[1;38m:: Upgrading Linux packages...\e[0m"
yaourt -Su --aur
echo -e "\e[1;38m:: Removing cached packages...\e[0m"
yes | yaourt -Scc 2>&1 >/dev/null

echo -e "\e[1;38m:: Updating antigen packages...\e[0m"
source /usr/share/zsh/share/antigen.zsh
antigen update

orphans="$(yaourt -Qdtq)"
if [ -n "$orphans" ]; then
  echo -e "\e[1;38m:: Removing orphaned packages...\e[0m"
  yaourt -Rns $(yaourt -Qdtq)
fi

if hash apm 2>/dev/null; then
  echo -e "\e[1;38m:: Upgrading Atom packages...\e[0m"
  echo -e "\e[1;38m:: $(apm upgrade --no-confirm 2>/dev/null)"
fi

