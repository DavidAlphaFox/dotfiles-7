#!/bin/bash

dir=.dotfiles                    # dotfiles directory
olddir=.old_dotfiles             # old dotfiles backup directory

mkdir -p ~/$olddir

# change to the dotfiles directory
cd ~

# symlink dotfiles, making backup of existing
for file in `ls ~/$dir | grep -v 'README.md'`; do
    echo ~/$file
    cp -rL ~/.$file ~/$olddir/
    rm -r ~/.$file
    ln -s $dir/$file .$file
done

# home directory symlinks
ln -s `cygpath $USERPROFILE` .user
ln -s $HOME /home/.admin

# symlinks into windows User directory
for i in Desktop Public Documents Downloads Pictures Music Videos Diagrams Templates; do 
    ln -s .user/$i $i
done

source ~/.bashrc

# install shell context-menu
chere -u
chere -icm -t mintty -s bash -e 'Shell...'

# install XWin to Windows Startup
cp ~/$dir/extra/cygwinx.lnk `cygpath $APPDATA`/Microsoft/Windows/Start\ Menu/Programs/Startup/

sudo reg import ~/.extra/xmouse.reg

